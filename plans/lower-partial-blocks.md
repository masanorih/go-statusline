# シェードブロックから下方向部分ブロックへの変更

## 概要

シェードブロック (░▒▓) はフォントによって半角/全角の扱いが不安定 (East Asian Width: Ambiguous)。
半角幅が保証されている下方向部分ブロック (▁▂▃▅▆▇) に置き換える。
▄ (下半分) は Ambiguous のため除外し、6段階で表現する。

左方向部分ブロック (▏▎▍▌▋▊▉) も Narrow だが、█ と視覚的に一体化してしまい
端数表示が認識しづらいため、高さで量を表す下方向ブロックを採用した。

## 変更対象ファイル

- `/Users/haram/git/go-statusline/main.go` (145-169行目)
- `/Users/haram/git/go-statusline/main_test.go` (440-475行目)

## 実装内容

### main.go: switch 文の変更

変更前:
```go
switch {
case fraction >= 2.0/3.0:
    shade = "▓"
    shadeWidth = 1
case fraction >= 1.0/3.0:
    shade = "▒"
    shadeWidth = 1
case fraction > 0:
    shade = "░"
    shadeWidth = 1
}
```

変更後:
```go
switch {
case fraction >= 5.0/6.0:
    shade = "▇"
    shadeWidth = 1
case fraction >= 4.0/6.0:
    shade = "▆"
    shadeWidth = 1
case fraction >= 3.0/6.0:
    shade = "▅"
    shadeWidth = 1
case fraction >= 2.0/6.0:
    shade = "▃"
    shadeWidth = 1
case fraction >= 1.0/6.0:
    shade = "▂"
    shadeWidth = 1
case fraction > 0:
    shade = "▁"
    shadeWidth = 1
}
```

### main.go: コメント更新

変更前: `// シェードブロック文字を使用してfraction > 0で常にシェード表示`
変更後: `// 下方向部分ブロック文字(▁▂▃▅▆▇)で6段階の小数部を表現`

### main_test.go: テストケースの期待値更新

全テストケースの fraction -> 文字の対応:

| usage  | fraction | 旧文字 | 新文字 | 閾値判定         |
|--------|----------|--------|--------|------------------|
| 0%     | 0.0      | なし   | なし   | fraction=0       |
| 1%     | 0.2      | ░      | ▂      | >=1/6 (0.167)    |
| 2%     | 0.4      | ▒      | ▃      | >=2/6 (0.333)    |
| 3%     | 0.6      | ▒      | ▅      | >=3/6 (0.500)    |
| 4%     | 0.8      | ▓      | ▆      | >=4/6 (0.667)    |
| 5%     | 0.0      | なし   | なし   | filled=1         |
| 24.9%  | 0.98     | ▓      | ▇      | >=5/6 (0.833)    |
| 25%    | 0.0      | なし   | なし   | filled=5         |
| 33%    | 0.6      | ▒      | ▅      | >=3/6 (0.500)    |
| 37%    | 0.4      | ▒      | ▃      | >=2/6 (0.333)    |
| 49.9%  | 0.98     | ▓      | ▇      | >=5/6 (0.833)    |
| 50%    | 0.0      | なし   | なし   | filled=10        |
| 67%    | 0.4      | ▒      | ▃      | >=2/6 (0.333)    |
| 74.9%  | 0.98     | ▓      | ▇      | >=5/6 (0.833)    |
| 75%    | 0.0      | なし   | なし   | filled=15        |
| 88%    | 0.6      | ▒      | ▅      | >=3/6 (0.500)    |
| 99%    | 0.8      | ▓      | ▆      | >=4/6 (0.667)    |
| 99.9%  | 0.98     | ▓      | ▇      | >=5/6 (0.833)    |
| 100%   | 0.0      | なし   | なし   | filled=20        |

## 検証

```bash
go test -v -run TestColorizeUsage
go test ./...
```

## 設計判断の経緯

| 候補                     | 段階 | EAW       | 視認性             | 採用 |
|--------------------------|------|-----------|--------------------|------|
| シェード (░▒▓)           | 3    | Ambiguous | 高                 | x    |
| 左方向部分 (▏▎▍▌▋▊▉)    | 7    | Narrow    | 低(█と一体化)      | x    |
| 下方向部分 (▁▂▃▅▆▇)     | 6    | Narrow    | 高(高さで区別)     | o    |
| 四分区画 (▖▌▙)           | 3    | 混在      | 低(不連続)         | x    |
